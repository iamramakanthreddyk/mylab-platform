graph TD
    %% ============================================================================
    %% MYLAB PLATFORM DATABASE HIERARCHY & DATA FLOW
    %% ============================================================================

    %% SuperAdmin Level
    SA[ğŸ‘‘ SuperAdmin<br/>PlatformAdmin] -->|creates| WS[ğŸ¢ Workspace<br/>Digital Container]

    %% Workspace Level
    WS -->|owns| ORG[ğŸ­ Organization<br/>Business Entity]
    WS -->|contains| USERS[ğŸ‘¥ Users<br/>Team Members]
    WS -->|has| SUB[ğŸ’° Subscription<br/>Billing]
    WS -->|contains| PROJ[ğŸ“ Projects<br/>Research Work]
    WS -->|contains| SAMP[ğŸ§ª Samples<br/>Lab Materials]
    WS -->|contains| BATCH[ğŸ“¦ Batches<br/>Analysis Groups]
    WS -->|contains| ANALY[ğŸ“Š Analyses<br/>Test Results]

    %% Organization Level
    ORG -->|employs| USERS
    ORG -->|clients_for| PROJ
    ORG -->|executes| PROJ
    ORG -->|requests| SCR[ğŸ”„ SupplyChainRequests<br/>Collaboration]
    ORG -->|grants_access| AG[ğŸ” AccessGrants<br/>Permissions]
    ORG -->|owns| APIK[ğŸ”‘ APIKeys<br/>Integration]

    %% User Level
    USERS -->|creates| PROJ
    USERS -->|creates| SAMP
    USERS -->|creates| BATCH
    USERS -->|performs| ANALY
    USERS -->|uploads| DOCS[ğŸ“„ Documents<br/>Files]
    USERS -->|generates| AUDIT[ğŸ“‹ AuditLog<br/>Activity Trail]

    %% Project Flow
    PROJ -->|contains| PSTAGE[ğŸ“‹ ProjectStages<br/>Milestones]
    PROJ -->|contains| SAMP
    PROJ -->|contains| DOCS

    %% Sample Processing Flow
    SAMP -->|processed_into| DSAMP[ğŸ§¬ DerivedSamples<br/>Modified Materials]
    DSAMP -->|grouped_into| BITEMS[ğŸ“¦ BatchItems<br/>Batch Contents]
    BITEMS -->|belongs_to| BATCH
    BATCH -->|analyzed_in| ANALY

    %% Collaboration Flow
    SCR -->|fulfilled_by| MH[ğŸ“¦ MaterialHandoff<br/>Transfer Records]
    AG -->|enables| DT[ğŸ« DownloadTokens<br/>Access Tokens]

    %% Business Flow
    SUB -->|based_on| PLAN[ğŸ“‹ Plans<br/>Feature Tiers]
    PLAN -->|includes| PFEAT[âš™ï¸ PlanFeatures<br/>Capabilities]
    PFEAT -->|controls| FEAT[ğŸ”§ Features<br/>Platform Functions]

    %% Monitoring & Security
    USERS -->|tracked_in| UM[ğŸ“Š UsageMetrics<br/>Consumption]
    USERS -->|logged_in| LL[ğŸ”‘ LastLogin<br/>Session Tracking]
    FEAT -->|usage_logged| FUSAGE[ğŸ“ˆ FeatureUsage<br/>Function Usage]
    AUDIT -->|security_events| SLOG[ğŸš¨ SecurityLog<br/>Security Events]

    %% Onboarding Flow
    ORG -->|created_via| COR[ğŸ“ CompanyOnboardingRequests<br/>Registration]
    COR -->|generates| CI[ğŸ“§ CompanyInvitations<br/>User Invites]
    COR -->|billed_via| CPAY[ğŸ’³ CompanyPayments<br/>Billing]

    %% Metadata & History
    SAMP -->|history| SMH[ğŸ“š SampleMetadataHistory<br/>Change Tracking]
    DSAMP -->|history| SMH

    %% Styling
    classDef superAdmin fill:#ff6b6b,color:white,stroke:#d63031,stroke-width:3px
    classDef workspace fill:#74b9ff,color:white,stroke:#0984e3,stroke-width:2px
    classDef organization fill:#a29bfe,color:white,stroke:#6c5ce7,stroke-width:2px
    classDef users fill:#fdcb6e,color:black,stroke:#e17055,stroke-width:2px
    classDef data fill:#55efc4,color:black,stroke:#00b894,stroke-width:2px
    classDef security fill:#e17055,color:white,stroke:#d63031,stroke-width:2px
    classDef business fill:#fd79a8,color:white,stroke:#e84393,stroke-width:2px

    class SA superAdmin
    class WS workspace
    class ORG organization
    class USERS users
    class PROJ,SAMP,BATCH,ANALY,DOCS,PSTAGE,DSAMP,BITEMS data
    class AUDIT,SLOG,AG,APIK,DT,LL security
    class SUB,PLAN,PFEAT,FEAT,UM,FUSAGE,CPAY business
    class SCR,MH,COR,CI,SMH data