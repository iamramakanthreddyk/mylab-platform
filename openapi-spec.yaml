openapi: 3.0.3
info:
  title: MyLab Platform API
  description: Complete API specification for the MyLab Platform backend
  version: 1.1.0
  contact:
    name: MyLab Platform Team
servers:
  - url: http://localhost:3001/api
    description: Development server
  - url: https://api.mylab-platform.com/api
    description: Production server

security:
  - bearerAuth: []

paths:
  # ============================================================================
  # AUTHENTICATION
  # ============================================================================
  /auth/login:
    post:
      summary: User login
      description: Authenticate user and return JWT token
      tags: [Authentication]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  description: User email address
                password:
                  type: string
                  minLength: 1
                  description: User password
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/change-password:
    post:
      summary: Change password
      description: Change the authenticated user's password
      tags: [Authentication]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - currentPassword
                - newPassword
              properties:
                currentPassword:
                  type: string
                  description: Current password
                newPassword:
                  type: string
                  minLength: 8
                  description: New password
      responses:
        '200':
          description: Password changed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/refresh:
    post:
      summary: Refresh JWT token
      description: Refresh an expired JWT token
      tags: [Authentication]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  description: Refresh token
      responses:
        '200':
          description: Token refreshed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/forgot-password:
    post:
      summary: Request password reset
      description: Send password reset email (email enumeration safe)
      tags: [Authentication]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  description: User email address
      responses:
        '200':
          description: Reset email sent (always returns success)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /auth/reset-password:
    post:
      summary: Reset password
      description: Reset password using reset token
      tags: [Authentication]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
                - newPassword
              properties:
                token:
                  type: string
                  description: Password reset token
                newPassword:
                  type: string
                  minLength: 8
                  description: New password
      responses:
        '200':
          description: Password reset successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  # ============================================================================
  # USERS & INVITATIONS
  # ============================================================================
  /users/invite:
    post:
      summary: Invite user
      description: Create user invitation (admin/manager only)
      tags: [Users]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserInvitationRequest'
      responses:
        '201':
          description: Invitation created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/UserInvitation'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'

  /users/invitations:
    get:
      summary: List invitations
      description: Get workspace invitations (admin/manager only)
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, accepted, expired]
      responses:
        '200':
          description: Invitations list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserInvitationWithDetails'

  /users/accept-invitation:
    post:
      summary: Accept invitation
      description: Accept user invitation and create account
      tags: [Users]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AcceptInvitationRequest'
      responses:
        '200':
          description: Account created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /users/invitations/{id}:
    delete:
      summary: Cancel invitation
      description: Cancel user invitation (admin/manager only)
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Invitation cancelled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '403':
          $ref: '#/components/responses/Forbidden'

  /users:
    get:
      summary: List users
      description: Get workspace users
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          schema:
            type: string
        - name: role
          in: query
          schema:
            type: string
            enum: [admin, manager, scientist, viewer]
        - name: status
          in: query
          schema:
            type: string
            enum: [active, inactive]
      responses:
        '200':
          description: Users list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedResponse'
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'

  /users/{id}:
    get:
      summary: Get user
      description: Get user details
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: User details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '404':
          $ref: '#/components/responses/NotFound'

    patch:
      summary: Update user
      description: Update user details (self or admin)
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                email:
                  type: string
                  format: email
      responses:
        '200':
          description: User updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'

    delete:
      summary: Delete user
      description: Soft delete user (admin only)
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: User deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '403':
          $ref: '#/components/responses/Forbidden'

  # ============================================================================
  # ANALYSIS TYPES
  # ============================================================================
  /analysis-types:
    get:
      summary: List analysis types
      description: Get all analysis types (auto-seeds if empty)
      tags: [Analysis Types]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Analysis types list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AnalysisType'

    post:
      summary: Create analysis type
      description: Create new analysis type (admin only)
      tags: [Analysis Types]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalysisTypeRequest'
      responses:
        '201':
          description: Analysis type created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisType'
        '403':
          $ref: '#/components/responses/Forbidden'

  /analysis-types/{id}:
    get:
      summary: Get analysis type
      description: Get analysis type details
      tags: [Analysis Types]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Analysis type details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisType'

    patch:
      summary: Update analysis type
      description: Update analysis type (admin only)
      tags: [Analysis Types]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalysisTypeUpdateRequest'
      responses:
        '200':
          description: Analysis type updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisType'

    delete:
      summary: Delete analysis type
      description: Soft delete analysis type (admin only)
      tags: [Analysis Types]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Analysis type deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # ============================================================================
  # ANALYSIS REQUESTS
  # ============================================================================
  /analysis-requests:
    post:
      summary: Create analysis request
      description: Create new analysis request for external lab
      tags: [Analysis Requests]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalysisRequestRequest'
      responses:
        '201':
          description: Analysis request created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisRequest'

  /analysis-requests/incoming:
    get:
      summary: Get incoming requests
      description: Get analysis requests TO current organization
      tags: [Analysis Requests]
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, accepted, in_progress, completed, rejected]
        - name: priority
          in: query
          schema:
            type: string
            enum: [low, medium, high, urgent]
      responses:
        '200':
          description: Incoming requests
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AnalysisRequestWithDetails'

  /analysis-requests/outgoing:
    get:
      summary: Get outgoing requests
      description: Get analysis requests FROM current organization
      tags: [Analysis Requests]
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, accepted, in_progress, completed, rejected]
        - name: priority
          in: query
          schema:
            type: string
            enum: [low, medium, high, urgent]
      responses:
        '200':
          description: Outgoing requests
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AnalysisRequestWithDetails'

  /analysis-requests/{id}:
    get:
      summary: Get analysis request
      description: Get analysis request details
      tags: [Analysis Requests]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Analysis request details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisRequestWithDetails'

    patch:
      summary: Update request status
      description: Update analysis request status
      tags: [Analysis Requests]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [in_progress, completed]
                notes:
                  type: string
      responses:
        '200':
          description: Request updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisRequest'

  /analysis-requests/{id}/accept:
    post:
      summary: Accept request
      description: Accept analysis request and assign
      tags: [Analysis Requests]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - assignedTo
              properties:
                assignedTo:
                  type: string
                  format: uuid
                  description: User ID to assign the request to
      responses:
        '200':
          description: Request accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisRequest'

  /analysis-requests/{id}/reject:
    post:
      summary: Reject request
      description: Reject analysis request
      tags: [Analysis Requests]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - reason
              properties:
                reason:
                  type: string
                  description: Reason for rejection
      responses:
        '200':
          description: Request rejected
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AnalysisRequest'

  # ============================================================================
  # FILES
  # ============================================================================
  /files/upload:
    post:
      summary: Upload file
      description: Upload file with entity association
      tags: [Files]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
                - entityType
                - entityId
              properties:
                file:
                  type: string
                  format: binary
                  description: File to upload
                entityType:
                  type: string
                  enum: [sample, analysis, project, batch, organization]
                  description: Type of entity the file belongs to
                entityId:
                  type: string
                  format: uuid
                  description: ID of the entity
                description:
                  type: string
                  description: Optional file description
      responses:
        '201':
          description: File uploaded
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/FileDocument'

  /files/{id}:
    get:
      summary: Get file metadata
      description: Get file metadata
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: File metadata
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/FileDocument'

    patch:
      summary: Update file metadata
      description: Update file description and metadata
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                description:
                  type: string
                metadata:
                  type: object
                isPublic:
                  type: boolean
      responses:
        '200':
          description: File updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/FileDocument'

    delete:
      summary: Delete file
      description: Soft delete file
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: File deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /files/{id}/download:
    get:
      summary: Download file
      description: Download file with integrity check
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: File download
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary

  /files/entity/{entityType}/{entityId}:
    get:
      summary: Get entity files
      description: Get all files for a specific entity
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
            enum: [sample, analysis, project, batch, organization]
        - name: entityId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Entity files
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/FileDocument'

  # ============================================================================
  # PROJECTS
  # ============================================================================
  /projects:
    get:
      summary: List projects
      description: Get workspace projects
      tags: [Projects]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Projects list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Project'
                  count:
                    type: integer

    post:
      summary: Create project
      description: Create new project
      tags: [Projects]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProjectRequest'
      responses:
        '201':
          description: Project created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Project'
                  message:
                    type: string

  /projects/{id}:
    get:
      summary: Get project
      description: Get project details
      tags: [Projects]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Project details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Project'

    put:
      summary: Update project
      description: Update project
      tags: [Projects]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProjectRequest'
      responses:
        '200':
          description: Project updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Project'
                  message:
                    type: string

    delete:
      summary: Delete project
      description: Delete project (admin required)
      tags: [Projects]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Project deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # ============================================================================
  # PROJECT STAGES (Nested)
  # ============================================================================
  /projects/{projectId}/stages:
    get:
      summary: List project stages
      description: Get stages for a project
      tags: [Projects, Stages]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Project stages
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Stage'

    post:
      summary: Create stage
      description: Create new project stage
      tags: [Projects, Stages]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateStageRequest'
      responses:
        '201':
          description: Stage created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Stage'

  /projects/{projectId}/stages/{id}:
    get:
      summary: Get stage
      description: Get stage details
      tags: [Projects, Stages]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Stage details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Stage'

    put:
      summary: Update stage
      description: Update project stage
      tags: [Projects, Stages]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateStageRequest'
      responses:
        '200':
          description: Stage updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Stage'

    delete:
      summary: Delete stage
      description: Delete project stage
      tags: [Projects, Stages]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Stage deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # ============================================================================
  # PROJECT TRIALS (Nested)
  # ============================================================================
  /projects/{projectId}/trials:
    get:
      summary: List project trials
      description: Get trials for a project
      tags: [Projects, Trials]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Project trials
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Trial'

    post:
      summary: Create trial(s)
      description: Create new project trial or multiple trials at once
      tags: [Projects, Trials]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/CreateTrialRequest'
                - $ref: '#/components/schemas/BulkCreateTrialRequest'
      responses:
        '201':
          description: Trial(s) created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    oneOf:
                      - $ref: '#/components/schemas/Trial'
                      - type: array
                        items:
                          $ref: '#/components/schemas/Trial'

  /projects/{projectId}/trials/{trialId}:
    get:
      summary: Get trial
      description: Get trial details
      tags: [Projects, Trials]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: trialId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Trial details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Trial'

    put:
      summary: Update trial
      description: Update project trial
      tags: [Projects, Trials]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: trialId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTrialRequest'
      responses:
        '200':
          description: Trial updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Trial'

    delete:
      summary: Delete trial
      description: Delete project trial
      tags: [Projects, Trials]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: trialId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Trial deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /projects/{projectId}/trials/{trialId}/parameters:
    get:
      summary: Get trial parameters
      description: Get parameters for a trial
      tags: [Projects, Trials]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: trialId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Trial parameters
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    description: Trial parameters object

    post:
      summary: Update trial parameters
      description: Update parameters for a trial
      tags: [Projects, Trials]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: trialId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Trial parameters object
      responses:
        '200':
          description: Parameters updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # ============================================================================
  # SAMPLES
  # ============================================================================
  /samples:
    get:
      summary: List samples
      description: Get workspace samples
      tags: [Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum: [active, archived, discarded]
      responses:
        '200':
          description: Samples list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedResponse'
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Sample'

    post:
      summary: Create sample
      description: Create new sample
      tags: [Samples]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSampleRequest'
      responses:
        '201':
          description: Sample created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Sample'

  /samples/{id}:
    get:
      summary: Get sample
      description: Get sample details
      tags: [Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Sample details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Sample'

    put:
      summary: Update sample
      description: Update sample
      tags: [Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSampleRequest'
      responses:
        '200':
          description: Sample updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Sample'

    delete:
      summary: Delete sample
      description: Delete sample (optionally cascade delete all derived samples with admin permission)
      tags: [Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: cascade
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: If true, deletes all derived samples (requires admin role)
      responses:
        '200':
          description: Sample deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # ============================================================================
  # DERIVED SAMPLES
  # ============================================================================
  /derived-samples:
    get:
      summary: List derived samples
      description: Get derived samples
      tags: [Derived Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: parentSampleId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Derived samples list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedResponse'
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/DerivedSample'

    post:
      summary: Create derived sample
      description: Create new derived sample
      tags: [Derived Samples]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDerivedSampleRequest'
      responses:
        '201':
          description: Derived sample created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/DerivedSample'

  /derived-samples/{id}:
    get:
      summary: Get derived sample
      description: Get derived sample details
      tags: [Derived Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Derived sample details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/DerivedSample'

    put:
      summary: Update derived sample
      description: Update derived sample
      tags: [Derived Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDerivedSampleRequest'
      responses:
        '200':
          description: Derived sample updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/DerivedSample'

    delete:
      summary: Delete derived sample
      description: Delete derived sample
      tags: [Derived Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Derived sample deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /derived-samples/{id}/share:
    post:
      summary: Share derived sample
      description: Share derived sample with other users
      tags: [Derived Samples]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                permissions:
                  type: string
                  enum: [read, write]
                  default: read
      responses:
        '200':
          description: Sample shared
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # ============================================================================
  # ANALYSES API
  # ============================================================================
  /analyses:
    get:
      summary: List analyses
      description: Get a paginated list of analyses with optional filtering
      tags: [Analyses]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: workspaceId
          in: query
          schema:
            type: string
            format: uuid
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, in_progress, completed, failed, cancelled]
        - name: analysisTypeId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of analyses
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Analysis'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create analysis
      description: Create a new analysis request
      tags: [Analyses]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAnalysisRequest'
      responses:
        '201':
          description: Analysis created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Analysis'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /analyses/{id}:
    get:
      summary: Get analysis by ID
      description: Get detailed information about a specific analysis
      tags: [Analyses]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Analysis details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Analysis'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Analysis not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update analysis
      description: Update an existing analysis
      tags: [Analyses]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAnalysisRequest'
      responses:
        '200':
          description: Analysis updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Analysis'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Analysis not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete analysis
      description: Delete an analysis (soft delete)
      tags: [Analyses]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Analysis deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Analysis not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /analyses/{id}/results:
    get:
      summary: Get analysis results
      description: Get the results of a completed analysis
      tags: [Analyses]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Analysis results
          content:
            application/json:
              schema:
                type: object
                properties:
                  analysisId:
                    type: string
                    format: uuid
                  results:
                    type: object
                    description: Analysis results data
                  generatedAt:
                    type: string
                    format: date-time
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Analysis not found or results not available
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Submit analysis results
      description: Submit results for an analysis (typically called by analysis service)
      tags: [Analyses]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - results
              properties:
                results:
                  type: object
                  description: Analysis results data
                metadata:
                  type: object
      responses:
        '200':
          description: Results submitted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Analysis'
        '400':
          description: Invalid results data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Analysis not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # BATCHES API
  # ============================================================================
  /batches:
    get:
      summary: List batches
      description: Get a paginated list of batches with optional filtering
      tags: [Batches]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: workspaceId
          in: query
          schema:
            type: string
            format: uuid
        - name: projectId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum: [draft, active, completed, archived]
        - name: batchType
          in: query
          schema:
            type: string
            enum: [production, qc, research, validation]
      responses:
        '200':
          description: List of batches
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Batch'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create batch
      description: Create a new batch
      tags: [Batches]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateBatchRequest'
      responses:
        '201':
          description: Batch created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Batch'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /batches/{id}:
    get:
      summary: Get batch by ID
      description: Get detailed information about a specific batch
      tags: [Batches]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Batch details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Batch'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update batch
      description: Update an existing batch
      tags: [Batches]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateBatchRequest'
      responses:
        '200':
          description: Batch updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Batch'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete batch
      description: Delete a batch (soft delete)
      tags: [Batches]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Batch deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /batches/{id}/samples:
    get:
      summary: Get batch samples
      description: Get all samples associated with a batch
      tags: [Batches]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Batch samples
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Sample'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Add sample to batch
      description: Add a sample to an existing batch
      tags: [Batches]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sampleId
              properties:
                sampleId:
                  type: string
                  format: uuid
      responses:
        '200':
          description: Sample added to batch successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Batch'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Batch or sample not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /batches/{id}/analyses:
    get:
      summary: Get batch analyses
      description: Get all analyses associated with a batch
      tags: [Batches]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Batch analyses
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Analysis'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # SUPPLY CHAIN API
  # ============================================================================
  /supply-chain/materials:
    get:
      summary: List materials
      description: Get a paginated list of materials in the supply chain
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: supplierId
          in: query
          schema:
            type: string
            format: uuid
        - name: category
          in: query
          schema:
            type: string
        - name: status
          in: query
          schema:
            type: string
            enum: [active, discontinued, pending]
      responses:
        '200':
          description: List of materials
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Material'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create material
      description: Create a new material in the supply chain
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMaterialRequest'
      responses:
        '201':
          description: Material created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Material'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /supply-chain/materials/{id}:
    get:
      summary: Get material by ID
      description: Get detailed information about a specific material
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Material details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Material'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Material not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update material
      description: Update an existing material
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMaterialRequest'
      responses:
        '200':
          description: Material updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Material'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Material not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete material
      description: Delete a material (soft delete)
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Material deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Material not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /supply-chain/suppliers:
    get:
      summary: List suppliers
      description: Get a paginated list of suppliers
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          schema:
            type: string
            enum: [active, inactive, pending]
      responses:
        '200':
          description: List of suppliers
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Supplier'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create supplier
      description: Create a new supplier
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSupplierRequest'
      responses:
        '201':
          description: Supplier created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Supplier'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /supply-chain/orders:
    get:
      summary: List orders
      description: Get a paginated list of supply chain orders
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: supplierId
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum: [draft, submitted, approved, shipped, delivered, cancelled]
      responses:
        '200':
          description: List of orders
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Order'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create order
      description: Create a new supply chain order
      tags: [Supply Chain]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrderRequest'
      responses:
        '201':
          description: Order created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  # ============================================================================
  # WORKSPACES API
  # ============================================================================
  /workspaces:
    get:
      summary: List workspaces
      description: Get a paginated list of workspaces the user has access to
      tags: [Workspaces]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          schema:
            type: string
            enum: [active, archived, suspended]
      responses:
        '200':
          description: List of workspaces
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Workspace'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      summary: Create workspace
      description: Create a new workspace
      tags: [Workspaces]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWorkspaceRequest'
      responses:
        '201':
          description: Workspace created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /workspaces/{id}:
    get:
      summary: Get workspace by ID
      description: Get detailed information about a specific workspace
      tags: [Workspaces]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Workspace details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update workspace
      description: Update an existing workspace
      tags: [Workspaces]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateWorkspaceRequest'
      responses:
        '200':
          description: Workspace updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Workspace'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete workspace
      description: Delete a workspace (soft delete)
      tags: [Workspaces]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Workspace deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /workspaces/{id}/members:
    get:
      summary: Get workspace members
      description: Get all members of a workspace
      tags: [Workspaces]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Workspace members
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/WorkspaceMember'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Workspace not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Add workspace member
      description: Add a user to a workspace with specified role
      tags: [Workspaces]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - role
              properties:
                userId:
                  type: string
                  format: uuid
                role:
                  type: string
                  enum: [owner, admin, member, viewer]
      responses:
        '200':
          description: Member added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkspaceMember'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Workspace or user not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # ACCESS CONTROL API
  # ============================================================================
  /access-control/roles:
    get:
      summary: List roles
      description: Get a paginated list of roles
      tags: [Access Control]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: workspaceId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of roles
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Role'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create role
      description: Create a new role with permissions
      tags: [Access Control]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRoleRequest'
      responses:
        '201':
          description: Role created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /access-control/roles/{id}:
    get:
      summary: Get role by ID
      description: Get detailed information about a specific role
      tags: [Access Control]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Role details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update role
      description: Update an existing role
      tags: [Access Control]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRoleRequest'
      responses:
        '200':
          description: Role updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Role'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete role
      description: Delete a role (soft delete)
      tags: [Access Control]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Role deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /access-control/permissions:
    get:
      summary: List permissions
      description: Get a list of all available permissions
      tags: [Access Control]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of permissions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Permission'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /access-control/user-permissions:
    get:
      summary: Get user permissions
      description: Get permissions for the current user or a specific user
      tags: [Access Control]
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: query
          schema:
            type: string
            format: uuid
          description: User ID (defaults to current user if not provided)
        - name: workspaceId
          in: query
          schema:
            type: string
            format: uuid
        - name: resourceType
          in: query
          schema:
            type: string
          description: Filter by resource type
        - name: resourceId
          in: query
          schema:
            type: string
            format: uuid
          description: Filter by specific resource ID
      responses:
        '200':
          description: User permissions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserPermission'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  # ============================================================================
  # API KEYS API
  # ============================================================================
  /api-keys:
    get:
      summary: List API keys
      description: Get a paginated list of API keys for the current user
      tags: [API Keys]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          schema:
            type: string
            enum: [active, inactive, expired]
      responses:
        '200':
          description: List of API keys
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ApiKey'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'

    post:
      summary: Create API key
      description: Create a new API key
      tags: [API Keys]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateApiKeyRequest'
      responses:
        '201':
          description: API key created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKey'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /api-keys/{id}:
    get:
      summary: Get API key by ID
      description: Get detailed information about a specific API key
      tags: [API Keys]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: API key details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKey'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: API key not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update API key
      description: Update an existing API key
      tags: [API Keys]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateApiKeyRequest'
      responses:
        '200':
          description: API key updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKey'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: API key not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete API key
      description: Delete an API key
      tags: [API Keys]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: API key deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: API key not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api-keys/{id}/regenerate:
    post:
      summary: Regenerate API key
      description: Regenerate the secret for an existing API key
      tags: [API Keys]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: API key regenerated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiKey'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: API key not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # NOTIFICATIONS API
  # ============================================================================
  /notifications:
    get:
      summary: List notifications
      description: Get a paginated list of notifications for the current user
      tags: [Notifications]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          schema:
            type: string
            enum: [unread, read, archived]
        - name: type
          in: query
          schema:
            type: string
            enum: [info, warning, error, success]
      responses:
        '200':
          description: List of notifications
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /notifications/{id}:
    get:
      summary: Get notification by ID
      description: Get detailed information about a specific notification
      tags: [Notifications]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Notification details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: Notification not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update notification
      description: Update notification status (mark as read/unread)
      tags: [Notifications]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationRequest'
      responses:
        '200':
          description: Notification updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Notification'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: Notification not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /notifications/mark-all-read:
    post:
      summary: Mark all notifications as read
      description: Mark all unread notifications as read for the current user
      tags: [Notifications]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: All notifications marked as read
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /notifications/bulk-update:
    post:
      summary: Bulk update notifications
      description: Update multiple notifications at once
      tags: [Notifications]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - notificationIds
                - status
              properties:
                notificationIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                status:
                  type: string
                  enum: [read, archived]
      responses:
        '200':
          description: Notifications updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  updatedCount:
                    type: integer
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /notification-settings:
    get:
      summary: Get notification settings
      description: Get notification preferences for the current user
      tags: [Notifications]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Notification settings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSettings'
        '401':
          $ref: '#/components/responses/Unauthorized'

    put:
      summary: Update notification settings
      description: Update notification preferences for the current user
      tags: [Notifications]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationSettingsRequest'
      responses:
        '200':
          description: Notification settings updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSettings'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  # ============================================================================
  # ADMIN API
  # ============================================================================
  /admin/users:
    get:
      summary: List all users
      description: Get a paginated list of all users in the system (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          schema:
            type: string
            enum: [active, inactive, suspended, pending]
        - name: role
          in: query
          schema:
            type: string
        - name: search
          in: query
          schema:
            type: string
            description: Search by name or email
      responses:
        '200':
          description: List of users
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /admin/users/{id}:
    get:
      summary: Get user details
      description: Get detailed information about any user (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: User details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update user
      description: Update any user in the system (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AdminUpdateUserRequest'
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /admin/workspaces:
    get:
      summary: List all workspaces
      description: Get a paginated list of all workspaces in the system (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: status
          in: query
          schema:
            type: string
            enum: [active, archived, suspended]
      responses:
        '200':
          description: List of workspaces
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Workspace'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /admin/analytics:
    get:
      summary: Get system analytics
      description: Get system-wide analytics and metrics (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      parameters:
        - name: period
          in: query
          schema:
            type: string
            enum: [day, week, month, year]
            default: month
        - name: startDate
          in: query
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          schema:
            type: string
            format: date
      responses:
        '200':
          description: System analytics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemAnalytics'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /admin/system-health:
    get:
      summary: Get system health
      description: Get system health and status information (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: System health status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemHealth'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /admin/settings:
    get:
      summary: Get system settings
      description: Get system-wide configuration settings (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: System settings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemSettings'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    put:
      summary: Update system settings
      description: Update system-wide configuration settings (admin only)
      tags: [Admin]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSystemSettingsRequest'
      responses:
        '200':
          description: System settings updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SystemSettings'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  # ============================================================================
  # COMPANY API
  # ============================================================================
  /company/profile:
    get:
      summary: Get company profile
      description: Get the current user's company profile information
      tags: [Company]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Company profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Company'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: Company not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update company profile
      description: Update the current user's company profile
      tags: [Company]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCompanyRequest'
      responses:
        '200':
          description: Company profile updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Company'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Company not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /company/locations:
    get:
      summary: List company locations
      description: Get a list of all company locations
      tags: [Company]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of company locations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CompanyLocation'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create company location
      description: Create a new company location
      tags: [Company]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCompanyLocationRequest'
      responses:
        '201':
          description: Company location created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyLocation'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /company/locations/{id}:
    get:
      summary: Get company location
      description: Get detailed information about a specific company location
      tags: [Company]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Company location details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyLocation'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Company location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update company location
      description: Update an existing company location
      tags: [Company]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCompanyLocationRequest'
      responses:
        '200':
          description: Company location updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyLocation'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Company location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete company location
      description: Delete a company location
      tags: [Company]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Company location deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Company location not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /company/departments:
    get:
      summary: List company departments
      description: Get a list of all company departments
      tags: [Company]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of company departments
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CompanyDepartment'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create company department
      description: Create a new company department
      tags: [Company]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCompanyDepartmentRequest'
      responses:
        '201':
          description: Company department created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompanyDepartment'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  # ============================================================================
  # INTEGRATIONS API
  # ============================================================================
  /integrations:
    get:
      summary: List integrations
      description: Get a list of available integrations and their status
      tags: [Integrations]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of integrations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Integration'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /integrations/{provider}/connect:
    post:
      summary: Connect integration
      description: Connect to an external service provider
      tags: [Integrations]
      security:
        - bearerAuth: []
      parameters:
        - name: provider
          in: path
          required: true
          schema:
            type: string
            enum: [slack, teams, jira, github, gitlab, dropbox, google_drive, onedrive, aws_s3, azure_blob]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConnectIntegrationRequest'
      responses:
        '200':
          description: Integration connected successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Integration'
        '400':
          description: Invalid request data or connection failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /integrations/{provider}/disconnect:
    post:
      summary: Disconnect integration
      description: Disconnect from an external service provider
      tags: [Integrations]
      security:
        - bearerAuth: []
      parameters:
        - name: provider
          in: path
          required: true
          schema:
            type: string
            enum: [slack, teams, jira, github, gitlab, dropbox, google_drive, onedrive, aws_s3, azure_blob]
      responses:
        '200':
          description: Integration disconnected successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Integration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /integrations/{provider}/sync:
    post:
      summary: Sync integration data
      description: Manually trigger synchronization with an external service
      tags: [Integrations]
      security:
        - bearerAuth: []
      parameters:
        - name: provider
          in: path
          required: true
          schema:
            type: string
            enum: [slack, teams, jira, github, gitlab, dropbox, google_drive, onedrive, aws_s3, azure_blob]
      responses:
        '200':
          description: Sync initiated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  syncId:
                    type: string
                    format: uuid
                  status:
                    type: string
                    enum: [pending, in_progress, completed, failed]
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Integration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /integrations/{provider}/webhooks:
    get:
      summary: Get integration webhooks
      description: Get webhook configurations for an integration
      tags: [Integrations]
      security:
        - bearerAuth: []
      parameters:
        - name: provider
          in: path
          required: true
          schema:
            type: string
            enum: [slack, teams, jira, github, gitlab]
      responses:
        '200':
          description: List of webhooks
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Webhook'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Integration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Create integration webhook
      description: Create a webhook configuration for an integration
      tags: [Integrations]
      security:
        - bearerAuth: []
      parameters:
        - name: provider
          in: path
          required: true
          schema:
            type: string
            enum: [slack, teams, jira, github, gitlab]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWebhookRequest'
      responses:
        '201':
          description: Webhook created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Webhook'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Integration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /integrations/oauth/callback:
    get:
      summary: OAuth callback
      description: Handle OAuth callback from external services
      tags: [Integrations]
      parameters:
        - name: code
          in: query
          required: true
          schema:
            type: string
        - name: state
          in: query
          required: true
          schema:
            type: string
        - name: provider
          in: query
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OAuth callback handled successfully
          content:
            text/html:
              schema:
                type: string
        '400':
          description: Invalid OAuth callback parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # TEAM MANAGEMENT API
  # ============================================================================
  /teams:
    get:
      summary: List teams
      description: Get a paginated list of teams in the current workspace
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: workspaceId
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of teams
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Team'
                  pagination:
                    $ref: '#/components/schemas/PaginationMeta'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      summary: Create team
      description: Create a new team in the current workspace
      tags: [Team Management]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTeamRequest'
      responses:
        '201':
          description: Team created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Team'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /teams/{id}:
    get:
      summary: Get team by ID
      description: Get detailed information about a specific team
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Team details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Team'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Team not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Update team
      description: Update an existing team
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTeamRequest'
      responses:
        '200':
          description: Team updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Team'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Team not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Delete team
      description: Delete a team (soft delete)
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Team deleted successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Team not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /teams/{id}/members:
    get:
      summary: Get team members
      description: Get all members of a team
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Team members
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TeamMember'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Team not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Add team member
      description: Add a user to a team with specified role
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - role
              properties:
                userId:
                  type: string
                  format: uuid
                role:
                  type: string
                  enum: [lead, member, contributor]
      responses:
        '200':
          description: Member added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamMember'
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Team or user not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Remove team member
      description: Remove a user from a team
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: Member removed successfully
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Team or user not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /teams/{id}/projects:
    get:
      summary: Get team projects
      description: Get all projects assigned to a team
      tags: [Team Management]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Team projects
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Project'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          description: Team not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # ============================================================================
    # COMMON SCHEMAS
    # ============================================================================
    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: "Operation completed successfully"

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          example: "Error message"
        details:
          type: object
          description: Additional error details

    PaginatedResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: array
          items:
            type: object
        pagination:
          type: object
          properties:
            page:
              type: integer
              example: 1
            limit:
              type: integer
              example: 20
            total:
              type: integer
              example: 100
            totalPages:
              type: integer
              example: 5

    PaginationMeta:
      type: object
      properties:
        page:
          type: integer
          example: 1
        limit:
          type: integer
          example: 20
        total:
          type: integer
          example: 100
        totalPages:
          type: integer
          example: 5

    # ============================================================================
    # AUTH SCHEMAS
    # ============================================================================
    AuthResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            accessToken:
              type: string
              description: JWT access token
            refreshToken:
              type: string
              description: JWT refresh token
            user:
              $ref: '#/components/schemas/User'
            expiresIn:
              type: integer
              description: Token expiration time in seconds

    # ============================================================================
    # USER SCHEMAS
    # ============================================================================
    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        firstName:
          type: string
        lastName:
          type: string
        role:
          type: string
          enum: [admin, manager, scientist, viewer]
        status:
          type: string
          enum: [active, inactive]
        workspaceId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    UserInvitationRequest:
      type: object
      required:
        - email
        - role
      properties:
        email:
          type: string
          format: email
          description: Email address of the user to invite
        role:
          type: string
          enum: [admin, manager, scientist, viewer]
          description: Role to assign to the invited user
        expiresInDays:
          type: integer
          minimum: 1
          maximum: 30
          default: 7
          description: Number of days until invitation expires

    UserInvitation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        role:
          type: string
          enum: [admin, manager, scientist, viewer]
        expiresAt:
          type: string
          format: date-time
        invitationLink:
          type: string
          description: URL for accepting the invitation

    UserInvitationWithDetails:
      allOf:
        - $ref: '#/components/schemas/UserInvitation'
        - type: object
          properties:
            invitedByName:
              type: string
            invitedByEmail:
              type: string
            status:
              type: string
              enum: [pending, accepted, expired]
            createdAt:
              type: string
              format: date-time

    AcceptInvitationRequest:
      type: object
      required:
        - token
        - name
        - password
      properties:
        token:
          type: string
          description: Invitation token from email
        name:
          type: string
          description: Full name for new account
        password:
          type: string
          minLength: 8
          description: Password for new account

    # ============================================================================
    # ANALYSIS TYPE SCHEMAS
    # ============================================================================
    AnalysisType:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          description: Analysis type name
        description:
          type: string
          description: Detailed description
        methodology:
          type: string
          description: Analysis methodology
        isActive:
          type: boolean
          default: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    AnalysisTypeRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          description: Analysis type name
        description:
          type: string
          description: Detailed description
        methodology:
          type: string
          description: Analysis methodology
        isActive:
          type: boolean
          default: true

    AnalysisTypeUpdateRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        methodology:
          type: string
        isActive:
          type: boolean

    # ============================================================================
    # ANALYSIS REQUEST SCHEMAS
    # ============================================================================
    AnalysisRequestRequest:
      type: object
      required:
        - toOrganizationId
        - sampleId
        - analysisTypeId
        - description
      properties:
        toOrganizationId:
          type: string
          format: uuid
          description: ID of organization to send request to
        sampleId:
          type: string
          format: uuid
          description: ID of sample for analysis
        analysisTypeId:
          type: string
          format: uuid
          description: ID of requested analysis type
        description:
          type: string
          description: Detailed description of request
        methodologyRequirements:
          type: string
          description: Specific methodology requirements
        parameters:
          type: object
          description: Additional analysis parameters
        priority:
          type: string
          enum: [low, medium, high, urgent]
          default: medium
        dueDate:
          type: string
          format: date
          description: Requested completion date
        estimatedDuration:
          type: string
          description: Estimated analysis duration
        notes:
          type: string
          description: Additional notes

    AnalysisRequest:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        fromOrganizationId:
          type: string
          format: uuid
        toOrganizationId:
          type: string
          format: uuid
        sampleId:
          type: string
          format: uuid
        analysisTypeId:
          type: string
          format: uuid
        description:
          type: string
        methodologyRequirements:
          type: string
        parameters:
          type: object
        priority:
          type: string
          enum: [low, medium, high, urgent]
        status:
          type: string
          enum: [pending, accepted, in_progress, completed, rejected]
        dueDate:
          type: string
          format: date
        estimatedDuration:
          type: string
        assignedTo:
          type: string
          format: uuid
        notes:
          type: string
        createdBy:
          type: string
          format: uuid
        acceptedAt:
          type: string
          format: date-time
        completedAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    AnalysisRequestWithDetails:
      allOf:
        - $ref: '#/components/schemas/AnalysisRequest'
        - type: object
          properties:
            sample:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                name:
                  type: string
            analysisType:
              $ref: '#/components/schemas/AnalysisType'
            fromOrganization:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                name:
                  type: string
            toOrganization:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                name:
                  type: string
            assignedToUser:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                name:
                  type: string
                email:
                  type: string

    # ============================================================================
    # FILE SCHEMAS
    # ============================================================================
    FileDocument:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        uploadedBy:
          type: string
          format: uuid
        entityType:
          type: string
          enum: [sample, analysis, project, batch, organization]
        entityId:
          type: string
          format: uuid
        fileName:
          type: string
        filePath:
          type: string
        fileSize:
          type: integer
          format: int64
        fileType:
          type: string
        checksum:
          type: string
          description: SHA-256 checksum
        description:
          type: string
        metadata:
          type: object
        isPublic:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ============================================================================
    # PROJECT SCHEMAS
    # ============================================================================
    Project:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        name:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 2000
        clientOrgId:
          type: string
          format: uuid
        clientOrgName:
          type: string
        externalClientName:
          type: string
        executingOrgId:
          type: string
          format: uuid
        executingOrgName:
          type: string
        status:
          type: string
          enum: [active, completed, archived]
          default: active
        workflowMode:
          type: string
          enum: [analysis_first, trial_first]
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateProjectRequest:
      type: object
      required:
        - name
        - executingOrgId
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          maxLength: 2000
        clientOrgId:
          type: string
          format: uuid
        externalClientName:
          type: string
          maxLength: 255
        executingOrgId:
          type: string
          format: uuid
        workflowMode:
          type: string
          enum: [analysis_first, trial_first]
      anyOf:
        - required: [clientOrgId]
        - required: [externalClientName]

    UpdateProjectRequest:
      type: object
      properties:
        name:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 2000
        status:
          type: string
          enum: [active, completed, archived]
        workflowMode:
          type: string
          enum: [analysis_first, trial_first]

    # ============================================================================
    # STAGE SCHEMAS
    # ============================================================================
    Stage:
      type: object
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        name:
          type: string
          maxLength: 255
        description:
          type: string
        orderIndex:
          type: integer
          minimum: 0
        status:
          type: string
          enum: [active, completed, archived]
          default: active
        ownerWorkspaceId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateStageRequest:
      type: object
      required:
        - name
        - orderIndex
      properties:
        name:
          type: string
          maxLength: 255
        description:
          type: string
        orderIndex:
          type: integer
          minimum: 0

    UpdateStageRequest:
      type: object
      properties:
        name:
          type: string
          maxLength: 255
        description:
          type: string
        orderIndex:
          type: integer
          minimum: 0
        status:
          type: string
          enum: [active, completed, archived]

    # ============================================================================
    # TRIAL SCHEMAS
    # ============================================================================
    Trial:
      type: object
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [planned, in_progress, completed, cancelled]
        parameters:
          type: object
        results:
          type: object
        createdBy:
          type: string
          format: uuid
        assignedTo:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateTrialRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string
        parameters:
          type: object
        assignedTo:
          type: string
          format: uuid

    BulkCreateTrialRequest:
      type: object
      required:
        - trials
      properties:
        trials:
          type: array
          items:
            $ref: '#/components/schemas/CreateTrialRequest'

    UpdateTrialRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [planned, in_progress, completed, cancelled]
        parameters:
          type: object
        results:
          type: object
        assignedTo:
          type: string
          format: uuid

    # ============================================================================
    # SAMPLE SCHEMAS
    # ============================================================================
    Sample:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        projectName:
          type: string
        trialId:
          type: string
          format: uuid
        stageId:
          type: string
          format: uuid
        sampleId:
          type: string
          description: User-defined sample identifier
        description:
          type: string
        type:
          type: string
          description: Sample type/category
        metadata:
          type: object
          description: Additional sample metadata
        status:
          type: string
          enum: [active, archived, discarded]
          default: active
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateSampleRequest:
      type: object
      required:
        - projectId
        - sampleId
        - description
      properties:
        projectId:
          type: string
          format: uuid
        stageId:
          type: string
          format: uuid
        trialId:
          type: string
          format: uuid
        sampleId:
          type: string
        description:
          type: string
        type:
          type: string
        metadata:
          type: object

    UpdateSampleRequest:
      type: object
      properties:
        sampleId:
          type: string
        description:
          type: string
        type:
          type: string
        status:
          type: string
          enum: [active, archived, discarded]
        metadata:
          type: object
        stageId:
          type: string
          format: uuid
        trialId:
          type: string
          format: uuid

    # ============================================================================
    # DERIVED SAMPLE SCHEMAS
    # ============================================================================
    DerivedSample:
      type: object
      properties:
        id:
          type: string
          format: uuid
        parentSampleId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        derivationMethod:
          type: string
        metadata:
          type: object
        status:
          type: string
          enum: [active, archived, discarded]
          default: active
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateDerivedSampleRequest:
      type: object
      required:
        - parentSampleId
        - name
        - derivationMethod
      properties:
        parentSampleId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        derivationMethod:
          type: string
        metadata:
          type: object

    UpdateDerivedSampleRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        derivationMethod:
          type: string
        metadata:
          type: object
        status:
          type: string
          enum: [active, archived, discarded]

    # ============================================================================
    # ANALYSIS SCHEMAS
    # ============================================================================
    Analysis:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        sampleId:
          type: string
          format: uuid
        analysisTypeId:
          type: string
          format: uuid
        analysisTypeName:
          type: string
        name:
          type: string
        description:
          type: string
        parameters:
          type: object
          description: Analysis-specific parameters
        status:
          type: string
          enum: [pending, in_progress, completed, failed, cancelled]
          default: pending
        priority:
          type: string
          enum: [low, medium, high, urgent]
          default: medium
        assignedTo:
          type: string
          format: uuid
        results:
          type: object
          description: Analysis results (when completed)
        errorMessage:
          type: string
        startedAt:
          type: string
          format: date-time
        completedAt:
          type: string
          format: date-time
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateAnalysisRequest:
      type: object
      required:
        - projectId
        - analysisTypeId
        - name
      properties:
        projectId:
          type: string
          format: uuid
        sampleId:
          type: string
          format: uuid
        analysisTypeId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        parameters:
          type: object
        priority:
          type: string
          enum: [low, medium, high, urgent]
        assignedTo:
          type: string
          format: uuid

    UpdateAnalysisRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        parameters:
          type: object
        status:
          type: string
          enum: [pending, in_progress, completed, failed, cancelled]
        priority:
          type: string
          enum: [low, medium, high, urgent]
        assignedTo:
          type: string
          format: uuid
        results:
          type: object

    # ============================================================================
    # BATCH SCHEMAS
    # ============================================================================
    Batch:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        batchNumber:
          type: string
          description: Unique batch identifier
        name:
          type: string
        description:
          type: string
        batchType:
          type: string
          enum: [production, qc, research, validation]
        status:
          type: string
          enum: [draft, active, completed, archived]
          default: draft
        priority:
          type: string
          enum: [low, medium, high, urgent]
          default: medium
        targetCompletionDate:
          type: string
          format: date
        actualCompletionDate:
          type: string
          format: date
        metadata:
          type: object
          description: Additional batch metadata
        sampleCount:
          type: integer
          description: Number of samples in the batch
        analysisCount:
          type: integer
          description: Number of analyses in the batch
        assignedTo:
          type: string
          format: uuid
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateBatchRequest:
      type: object
      required:
        - projectId
        - batchNumber
        - name
        - batchType
      properties:
        projectId:
          type: string
          format: uuid
        batchNumber:
          type: string
        name:
          type: string
        description:
          type: string
        batchType:
          type: string
          enum: [production, qc, research, validation]
        priority:
          type: string
          enum: [low, medium, high, urgent]
        targetCompletionDate:
          type: string
          format: date
        metadata:
          type: object
        assignedTo:
          type: string
          format: uuid

    UpdateBatchRequest:
      type: object
      properties:
        batchNumber:
          type: string
        name:
          type: string
        description:
          type: string
        batchType:
          type: string
          enum: [production, qc, research, validation]
        status:
          type: string
          enum: [draft, active, completed, archived]
        priority:
          type: string
          enum: [low, medium, high, urgent]
        targetCompletionDate:
          type: string
          format: date
        actualCompletionDate:
          type: string
          format: date
        metadata:
          type: object
        assignedTo:
          type: string
          format: uuid

    # ============================================================================
    # SUPPLY CHAIN SCHEMAS
    # ============================================================================
    Material:
      type: object
      properties:
        id:
          type: string
          format: uuid
        supplierId:
          type: string
          format: uuid
        supplierName:
          type: string
        materialCode:
          type: string
          description: Unique material identifier
        name:
          type: string
        description:
          type: string
        category:
          type: string
        unit:
          type: string
          description: Unit of measurement (e.g., kg, L, pieces)
        specifications:
          type: object
          description: Technical specifications
        status:
          type: string
          enum: [active, discontinued, pending]
          default: active
        minimumOrderQuantity:
          type: number
        leadTime:
          type: integer
          description: Lead time in days
        unitPrice:
          type: number
          format: float
        currency:
          type: string
          default: USD
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateMaterialRequest:
      type: object
      required:
        - supplierId
        - materialCode
        - name
        - category
        - unit
      properties:
        supplierId:
          type: string
          format: uuid
        materialCode:
          type: string
        name:
          type: string
        description:
          type: string
        category:
          type: string
        unit:
          type: string
        specifications:
          type: object
        minimumOrderQuantity:
          type: number
        leadTime:
          type: integer
        unitPrice:
          type: number
          format: float
        currency:
          type: string

    UpdateMaterialRequest:
      type: object
      properties:
        supplierId:
          type: string
          format: uuid
        materialCode:
          type: string
        name:
          type: string
        description:
          type: string
        category:
          type: string
        unit:
          type: string
        specifications:
          type: object
        status:
          type: string
          enum: [active, discontinued, pending]
        minimumOrderQuantity:
          type: number
        leadTime:
          type: integer
        unitPrice:
          type: number
          format: float
        currency:
          type: string

    Supplier:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        contactPerson:
          type: string
        email:
          type: string
          format: email
        phone:
          type: string
        address:
          type: object
          properties:
            street:
              type: string
            city:
              type: string
            state:
              type: string
            zipCode:
              type: string
            country:
              type: string
        status:
          type: string
          enum: [active, inactive, pending]
          default: active
        rating:
          type: number
          format: float
          minimum: 0
          maximum: 5
        paymentTerms:
          type: string
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateSupplierRequest:
      type: object
      required:
        - name
        - contactPerson
        - email
      properties:
        name:
          type: string
        contactPerson:
          type: string
        email:
          type: string
          format: email
        phone:
          type: string
        address:
          type: object
          properties:
            street:
              type: string
            city:
              type: string
            state:
              type: string
            zipCode:
              type: string
            country:
              type: string
        paymentTerms:
          type: string

    Order:
      type: object
      properties:
        id:
          type: string
          format: uuid
        supplierId:
          type: string
          format: uuid
        supplierName:
          type: string
        orderNumber:
          type: string
          description: Unique order identifier
        status:
          type: string
          enum: [draft, submitted, approved, shipped, delivered, cancelled]
          default: draft
        orderDate:
          type: string
          format: date
        expectedDeliveryDate:
          type: string
          format: date
        actualDeliveryDate:
          type: string
          format: date
        items:
          type: array
          items:
            type: object
            properties:
              materialId:
                type: string
                format: uuid
              materialCode:
                type: string
              materialName:
                type: string
              quantity:
                type: number
              unitPrice:
                type: number
                format: float
              totalPrice:
                type: number
                format: float
        totalAmount:
          type: number
          format: float
        currency:
          type: string
          default: USD
        notes:
          type: string
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateOrderRequest:
      type: object
      required:
        - supplierId
        - orderNumber
        - items
      properties:
        supplierId:
          type: string
          format: uuid
        orderNumber:
          type: string
        orderDate:
          type: string
          format: date
        expectedDeliveryDate:
          type: string
          format: date
        items:
          type: array
          items:
            type: object
            required:
              - materialId
              - quantity
              - unitPrice
            properties:
              materialId:
                type: string
                format: uuid
              quantity:
                type: number
              unitPrice:
                type: number
                format: float
        currency:
          type: string
        notes:
          type: string

    # ============================================================================
    # WORKSPACE SCHEMAS
    # ============================================================================
    Workspace:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [active, archived, suspended]
          default: active
        settings:
          type: object
          description: Workspace-specific settings
        memberCount:
          type: integer
          description: Number of members in the workspace
        projectCount:
          type: integer
          description: Number of projects in the workspace
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateWorkspaceRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string
        settings:
          type: object

    UpdateWorkspaceRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [active, archived, suspended]
        settings:
          type: object

    WorkspaceMember:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        userName:
          type: string
        userEmail:
          type: string
          format: email
        role:
          type: string
          enum: [owner, admin, member, viewer]
        joinedAt:
          type: string
          format: date-time
        invitedBy:
          type: string
          format: uuid

    # ============================================================================
    # ACCESS CONTROL SCHEMAS
    # ============================================================================
    Role:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        permissions:
          type: array
          items:
            type: string
            description: Permission identifier
        isSystemRole:
          type: boolean
          default: false
        memberCount:
          type: integer
          description: Number of users with this role
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateRoleRequest:
      type: object
      required:
        - name
        - permissions
      properties:
        name:
          type: string
        description:
          type: string
        permissions:
          type: array
          items:
            type: string

    UpdateRoleRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        permissions:
          type: array
          items:
            type: string

    Permission:
      type: object
      properties:
        id:
          type: string
          description: Permission identifier
        name:
          type: string
          description: Human-readable permission name
        description:
          type: string
        resourceType:
          type: string
          description: Type of resource this permission applies to
        actions:
          type: array
          items:
            type: string
            enum: [create, read, update, delete, manage]
        scope:
          type: string
          enum: [global, workspace, project, resource]
          default: resource

    UserPermission:
      type: object
      properties:
        resourceType:
          type: string
        resourceId:
          type: string
          format: uuid
        permissions:
          type: array
          items:
            type: string
        grantedBy:
          type: string
          enum: [role, direct, ownership]
        roleId:
          type: string
          format: uuid
        roleName:
          type: string

    # ============================================================================
    # API KEY SCHEMAS
    # ============================================================================
    ApiKey:
      type: object
      properties:
        id:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        keyPrefix:
          type: string
          description: First few characters of the API key for identification
        status:
          type: string
          enum: [active, inactive, expired]
          default: active
        permissions:
          type: array
          items:
            type: string
          description: List of permissions granted to this API key
        expiresAt:
          type: string
          format: date-time
        lastUsedAt:
          type: string
          format: date-time
        usageCount:
          type: integer
          description: Number of times this key has been used
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateApiKeyRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string
        permissions:
          type: array
          items:
            type: string
        expiresAt:
          type: string
          format: date-time

    UpdateApiKeyRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [active, inactive, expired]
        permissions:
          type: array
          items:
            type: string
        expiresAt:
          type: string
          format: date-time

    # ============================================================================
    # NOTIFICATION SCHEMAS
    # ============================================================================
    Notification:
      type: object
      properties:
        id:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        title:
          type: string
        message:
          type: string
        type:
          type: string
          enum: [info, warning, error, success]
          default: info
        status:
          type: string
          enum: [unread, read, archived]
          default: unread
        priority:
          type: string
          enum: [low, medium, high, urgent]
          default: medium
        category:
          type: string
          description: Notification category (e.g., analysis, project, system)
        metadata:
          type: object
          description: Additional notification data
        actionUrl:
          type: string
          format: uri
          description: URL to navigate to when notification is clicked
        expiresAt:
          type: string
          format: date-time
        readAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    UpdateNotificationRequest:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: [read, archived]

    NotificationSettings:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        emailNotifications:
          type: boolean
          default: true
        pushNotifications:
          type: boolean
          default: true
        notificationTypes:
          type: object
          properties:
            analysis_complete:
              type: boolean
              default: true
            project_updates:
              type: boolean
              default: true
            system_alerts:
              type: boolean
              default: true
            team_invitations:
              type: boolean
              default: true
            batch_complete:
              type: boolean
              default: true
        quietHours:
          type: object
          properties:
            enabled:
              type: boolean
              default: false
            startTime:
              type: string
              format: time
            endTime:
              type: string
              format: time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    UpdateNotificationSettingsRequest:
      type: object
      properties:
        emailNotifications:
          type: boolean
        pushNotifications:
          type: boolean
        notificationTypes:
          type: object
          properties:
            analysis_complete:
              type: boolean
            project_updates:
              type: boolean
            system_alerts:
              type: boolean
            team_invitations:
              type: boolean
            batch_complete:
              type: boolean
        quietHours:
          type: object
          properties:
            enabled:
              type: boolean
            startTime:
              type: string
              format: time
            endTime:
              type: string
              format: time

    # ============================================================================
    # ADMIN SCHEMAS
    # ============================================================================
    AdminUpdateUserRequest:
      type: object
      properties:
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
          format: email
        status:
          type: string
          enum: [active, inactive, suspended, pending]
        role:
          type: string
        department:
          type: string
        jobTitle:
          type: string
        phone:
          type: string
        metadata:
          type: object

    SystemAnalytics:
      type: object
      properties:
        period:
          type: string
        totalUsers:
          type: integer
        activeUsers:
          type: integer
        totalWorkspaces:
          type: integer
        totalProjects:
          type: integer
        totalAnalyses:
          type: integer
        completedAnalyses:
          type: integer
        totalBatches:
          type: integer
        completedBatches:
          type: integer
        storageUsed:
          type: integer
          description: Storage used in bytes
        apiCalls:
          type: integer
        userGrowth:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
              count:
                type: integer
        projectActivity:
          type: array
          items:
            type: object
            properties:
              date:
                type: string
                format: date
              projectsCreated:
                type: integer
              analysesRun:
                type: integer

    SystemHealth:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, warning, critical]
        uptime:
          type: integer
          description: Uptime in seconds
        database:
          type: object
          properties:
            status:
              type: string
              enum: [connected, disconnected, error]
            responseTime:
              type: number
            connectionCount:
              type: integer
        api:
          type: object
          properties:
            status:
              type: string
              enum: [operational, degraded, down]
            responseTime:
              type: number
            errorRate:
              type: number
        storage:
          type: object
          properties:
            status:
              type: string
              enum: [healthy, warning, critical]
            usedSpace:
              type: integer
            totalSpace:
              type: integer
            availableSpace:
              type: integer
        backgroundJobs:
          type: object
          properties:
            status:
              type: string
              enum: [running, stopped, error]
            queuedJobs:
              type: integer
            failedJobs:
              type: integer
        lastChecked:
          type: string
          format: date-time

    SystemSettings:
      type: object
      properties:
        general:
          type: object
          properties:
            siteName:
              type: string
            siteDescription:
              type: string
            contactEmail:
              type: string
              format: email
            maintenanceMode:
              type: boolean
            defaultUserRole:
              type: string
        security:
          type: object
          properties:
            passwordMinLength:
              type: integer
            sessionTimeout:
              type: integer
            twoFactorRequired:
              type: boolean
            allowedDomains:
              type: array
              items:
                type: string
        limits:
          type: object
          properties:
            maxUsersPerWorkspace:
              type: integer
            maxProjectsPerWorkspace:
              type: integer
            maxFileSize:
              type: integer
            maxApiKeysPerUser:
              type: integer
        integrations:
          type: object
          properties:
            enabledProviders:
              type: array
              items:
                type: string
        notifications:
          type: object
          properties:
            smtpHost:
              type: string
            smtpPort:
              type: integer
            smtpUser:
              type: string
            emailFrom:
              type: string
              format: email
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    UpdateSystemSettingsRequest:
      type: object
      properties:
        general:
          type: object
          properties:
            siteName:
              type: string
            siteDescription:
              type: string
            contactEmail:
              type: string
              format: email
            maintenanceMode:
              type: boolean
            defaultUserRole:
              type: string
        security:
          type: object
          properties:
            passwordMinLength:
              type: integer
            sessionTimeout:
              type: integer
            twoFactorRequired:
              type: boolean
            allowedDomains:
              type: array
              items:
                type: string
        limits:
          type: object
          properties:
            maxUsersPerWorkspace:
              type: integer
            maxProjectsPerWorkspace:
              type: integer
            maxFileSize:
              type: integer
            maxApiKeysPerUser:
              type: integer
        integrations:
          type: object
          properties:
            enabledProviders:
              type: array
              items:
                type: string
        notifications:
          type: object
          properties:
            smtpHost:
              type: string
            smtpPort:
              type: integer
            smtpUser:
              type: string
            emailFrom:
              type: string
              format: email

    # ============================================================================
    # COMPANY SCHEMAS
    # ============================================================================
    Company:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        industry:
          type: string
        size:
          type: string
          enum: [startup, small, medium, large, enterprise]
        website:
          type: string
          format: uri
        logo:
          type: string
          format: uri
        address:
          type: object
          properties:
            street:
              type: string
            city:
              type: string
            state:
              type: string
            zipCode:
              type: string
            country:
              type: string
        contact:
          type: object
          properties:
            primaryEmail:
              type: string
              format: email
            primaryPhone:
              type: string
            supportEmail:
              type: string
              format: email
        settings:
          type: object
          description: Company-specific settings
        status:
          type: string
          enum: [active, inactive, suspended]
          default: active
        subscription:
          type: object
          properties:
            plan:
              type: string
            status:
              type: string
              enum: [active, expired, cancelled, trial]
            expiresAt:
              type: string
              format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    UpdateCompanyRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        industry:
          type: string
        size:
          type: string
          enum: [startup, small, medium, large, enterprise]
        website:
          type: string
          format: uri
        logo:
          type: string
          format: uri
        address:
          type: object
          properties:
            street:
              type: string
            city:
              type: string
            state:
              type: string
            zipCode:
              type: string
            country:
              type: string
        contact:
          type: object
          properties:
            primaryEmail:
              type: string
              format: email
            primaryPhone:
              type: string
            supportEmail:
              type: string
              format: email
        settings:
          type: object

    CompanyLocation:
      type: object
      properties:
        id:
          type: string
          format: uuid
        companyId:
          type: string
          format: uuid
        name:
          type: string
        type:
          type: string
          enum: [headquarters, branch, lab, office, warehouse]
        address:
          type: object
          properties:
            street:
              type: string
            city:
              type: string
            state:
              type: string
            zipCode:
              type: string
            country:
              type: string
        contact:
          type: object
          properties:
            phone:
              type: string
            email:
              type: string
              format: email
            manager:
              type: string
        capacity:
          type: integer
          description: Maximum capacity for this location
        status:
          type: string
          enum: [active, inactive, maintenance]
          default: active
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateCompanyLocationRequest:
      type: object
      required:
        - name
        - type
        - address
      properties:
        name:
          type: string
        type:
          type: string
          enum: [headquarters, branch, lab, office, warehouse]
        address:
          type: object
          required:
            - street
            - city
            - state
            - zipCode
            - country
          properties:
            street:
              type: string
            city:
              type: string
            state:
              type: string
            zipCode:
              type: string
            country:
              type: string
        contact:
          type: object
          properties:
            phone:
              type: string
            email:
              type: string
              format: email
            manager:
              type: string
        capacity:
          type: integer

    UpdateCompanyLocationRequest:
      type: object
      properties:
        name:
          type: string
        type:
          type: string
          enum: [headquarters, branch, lab, office, warehouse]
        address:
          type: object
          properties:
            street:
              type: string
            city:
              type: string
            state:
              type: string
            zipCode:
              type: string
            country:
              type: string
        contact:
          type: object
          properties:
            phone:
              type: string
            email:
              type: string
              format: email
            manager:
              type: string
        capacity:
          type: integer
        status:
          type: string
          enum: [active, inactive, maintenance]

    CompanyDepartment:
      type: object
      properties:
        id:
          type: string
          format: uuid
        companyId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        head:
          type: string
          format: uuid
          description: User ID of department head
        parentDepartmentId:
          type: string
          format: uuid
        memberCount:
          type: integer
        status:
          type: string
          enum: [active, inactive]
          default: active
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateCompanyDepartmentRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string
        head:
          type: string
          format: uuid
        parentDepartmentId:
          type: string
          format: uuid

    # ============================================================================
    # INTEGRATION SCHEMAS
    # ============================================================================
    Integration:
      type: object
      properties:
        id:
          type: string
          format: uuid
        provider:
          type: string
          enum: [slack, teams, jira, github, gitlab, dropbox, google_drive, onedrive, aws_s3, azure_blob]
        name:
          type: string
        description:
          type: string
        category:
          type: string
          enum: [communication, project_management, version_control, storage, cloud]
        status:
          type: string
          enum: [disconnected, connecting, connected, error]
          default: disconnected
        config:
          type: object
          description: Provider-specific configuration
        lastSyncAt:
          type: string
          format: date-time
        errorMessage:
          type: string
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    ConnectIntegrationRequest:
      type: object
      properties:
        apiKey:
          type: string
          description: API key for the service (if required)
        apiSecret:
          type: string
          description: API secret for the service (if required)
        accessToken:
          type: string
          description: OAuth access token
        refreshToken:
          type: string
          description: OAuth refresh token
        config:
          type: object
          description: Additional provider-specific configuration
        scopes:
          type: array
          items:
            type: string
          description: OAuth scopes to request

    Webhook:
      type: object
      properties:
        id:
          type: string
          format: uuid
        integrationId:
          type: string
          format: uuid
        url:
          type: string
          format: uri
        events:
          type: array
          items:
            type: string
          description: List of events to listen for
        secret:
          type: string
          description: Webhook secret for verification
        status:
          type: string
          enum: [active, inactive, failed]
          default: active
        lastTriggeredAt:
          type: string
          format: date-time
        failureCount:
          type: integer
          default: 0
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateWebhookRequest:
      type: object
      required:
        - url
        - events
      properties:
        url:
          type: string
          format: uri
        events:
          type: array
          items:
            type: string
        secret:
          type: string

    # ============================================================================
    # TEAM MANAGEMENT SCHEMAS
    # ============================================================================
    Team:
      type: object
      properties:
        id:
          type: string
          format: uuid
        workspaceId:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        color:
          type: string
          description: Hex color code for team identification
        avatar:
          type: string
          format: uri
        memberCount:
          type: integer
          description: Number of members in the team
        projectCount:
          type: integer
          description: Number of projects assigned to the team
        lead:
          type: string
          format: uuid
          description: User ID of team lead
        skills:
          type: array
          items:
            type: string
          description: List of skills/expertise areas
        status:
          type: string
          enum: [active, inactive, archived]
          default: active
        settings:
          type: object
          description: Team-specific settings
        createdBy:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        deletedAt:
          type: string
          format: date-time

    CreateTeamRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        description:
          type: string
        color:
          type: string
        avatar:
          type: string
          format: uri
        lead:
          type: string
          format: uuid
        skills:
          type: array
          items:
            type: string
        settings:
          type: object

    UpdateTeamRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        color:
          type: string
        avatar:
          type: string
          format: uri
        lead:
          type: string
          format: uuid
        skills:
          type: array
          items:
            type: string
        status:
          type: string
          enum: [active, inactive, archived]
        settings:
          type: object

    TeamMember:
      type: object
      properties:
        id:
          type: string
          format: uuid
        teamId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        userName:
          type: string
        userEmail:
          type: string
          format: email
        role:
          type: string
          enum: [lead, member, contributor]
        joinedAt:
          type: string
          format: date-time
        addedBy:
          type: string
          format: uuid

  # ============================================================================
  # RESPONSE COMPONENTS
  # ============================================================================
  responses:
    BadRequest:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    NotFound:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    ValidationError:
      description: Validation Error
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: "Validation failed"
              details:
                type: object
                description: Field-specific validation errors

    Conflict:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    TooManyRequests:
      description: Too Many Requests
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
